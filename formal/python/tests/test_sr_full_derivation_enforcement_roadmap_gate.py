from __future__ import annotations

from pathlib import Path


def find_repo_root(start: Path) -> Path:
    p = start.resolve()
    while p != p.parent:
        if (p / "formal").exists():
            return p
        p = p.parent
    raise RuntimeError("Could not locate repo root (expected a 'formal' directory).")


REPO_ROOT = find_repo_root(Path(__file__))
STATE_PATH = REPO_ROOT / "State_of_the_Theory.md"
ROADMAP_PATH = REPO_ROOT / "formal" / "docs" / "paper" / "PHYSICS_ROADMAP_v0.md"
SR_ENFORCEMENT_ROADMAP_PATH = (
    REPO_ROOT
    / "formal"
    / "docs"
    / "paper"
    / "DERIVATION_TARGET_SR_FULL_DERIVATION_ENFORCEMENT_ROADMAP_v0.md"
)


def _read(path: Path) -> str:
    assert path.exists(), f"Missing required file: {path}"
    return path.read_text(encoding="utf-8")


def test_sr_enforcement_roadmap_exists_and_pins_authoritative_tokens() -> None:
    text = _read(SR_ENFORCEMENT_ROADMAP_PATH)

    required_tokens = [
        "DERIVATION_TARGET_SR_FULL_DERIVATION_ENFORCEMENT_ROADMAP_v0",
        "TARGET-SR-FULL-DERIVATION-ENFORCEMENT-ROADMAP-PLAN",
        "SR_FULL_DERIVATION_ENFORCEMENT_ADJUDICATION: DISCHARGED_v0_ROADMAP_PINNED",
        "Authoritative no-deviation rule",
        "Phase I — Theorem-object realization",
        "Phase II — Canonical equivalence theorem",
        "Phase III — Assumption minimization discharge",
        "Phase IV — Robustness + negative-control discharge",
        "Phase V — Derivation-completeness gate discharge",
        "Phase VI — Inevitability gate discharge",
        "Phase VII — Package freeze and reopen policy",
        "Cycle-029 phase-exit token binding lock",
        "TARGET-SR-COV-MICRO-29-THEOREM-OBJECT-PHASE-EXIT-BINDING-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_PHASE_EXIT_BINDING_v0: CYCLE29_PHASE_EXIT_TOKENS_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_EXIT_v0: OBJECT_THEOREM_SURFACES_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_EXIT_v0: CANONICAL_EQUIVALENCE_SURFACE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_EXIT_v0: ASSUMPTION_MINIMIZATION_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_EXIT_v0: ROBUSTNESS_NEGCTRL_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_EXIT_v0: DERIVATION_COMPLETENESS_GATE_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_EXIT_v0: INEVITABILITY_GATE_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE7_EXIT_v0: PACKAGE_FREEZE_REOPEN_POLICY_BOUND_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE29_v0: THEOREM_OBJECT_PHASE_EXIT_BINDING_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE29_ARTIFACT_v0: sr_covariance_theorem_object_phase_exit_binding_cycle29_v0",
        "formal/output/sr_covariance_theorem_object_phase_exit_binding_cycle29_v0.json",
        "Cycle-030 phase-I theorem-object discharge progression lock",
        "TARGET-SR-COV-MICRO-30-THEOREM-OBJECT-DISCHARGE-PROGRESSION-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_PROGRESSION_v0: CYCLE30_PHASE1_DISCHARGE_PROGRESS_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_01_v0: LORENTZ_TRANSFORM_OBJECT_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_02_v0: INTERVAL_INVARIANCE_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_03_v0: VELOCITY_COMPOSITION_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_04_v0: COVARIANCE_CONTRACT_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_PROGRESS_v0: ROWS_01_04_POPULATED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE30_v0: THEOREM_OBJECT_DISCHARGE_PROGRESSION_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE30_ARTIFACT_v0: sr_covariance_theorem_object_discharge_progression_cycle30_v0",
        "formal/output/sr_covariance_theorem_object_discharge_progression_cycle30_v0.json",
        "Cycle-031 phase-I theorem-object discharge row-01 lock",
        "TARGET-SR-COV-MICRO-31-THEOREM-OBJECT-DISCHARGE-ROW01-LOCK-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW01_LOCK_v0: CYCLE31_PHASE1_ROW01_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_01_STATUS_v0: LORENTZ_TRANSFORM_OBJECT_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE31_v0: THEOREM_OBJECT_DISCHARGE_ROW01_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE31_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row01_lock_cycle31_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row01_lock_cycle31_v0.json",
        "Cycle-032 phase-I theorem-object discharge row-02 lock",
        "TARGET-SR-COV-MICRO-32-THEOREM-OBJECT-DISCHARGE-ROW02-LOCK-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW02_LOCK_v0: CYCLE32_PHASE1_ROW02_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_02_STATUS_v0: INTERVAL_INVARIANCE_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE32_v0: THEOREM_OBJECT_DISCHARGE_ROW02_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE32_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row02_lock_cycle32_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row02_lock_cycle32_v0.json",
        "Cycle-033 phase-I theorem-object discharge row-03 lock",
        "TARGET-SR-COV-MICRO-33-THEOREM-OBJECT-DISCHARGE-ROW03-LOCK-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW03_LOCK_v0: CYCLE33_PHASE1_ROW03_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_03_STATUS_v0: VELOCITY_COMPOSITION_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE33_v0: THEOREM_OBJECT_DISCHARGE_ROW03_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE33_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row03_lock_cycle33_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row03_lock_cycle33_v0.json",
        "Cycle-034 phase-I theorem-object discharge row-04 lock",
        "TARGET-SR-COV-MICRO-34-THEOREM-OBJECT-DISCHARGE-ROW04-LOCK-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW04_LOCK_v0: CYCLE34_PHASE1_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_04_STATUS_v0: COVARIANCE_CONTRACT_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE34_v0: THEOREM_OBJECT_DISCHARGE_ROW04_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE34_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row04_lock_cycle34_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row04_lock_cycle34_v0.json",
        "Cycle-035 phase-I theorem-object discharge completion transition lock",
        "TARGET-SR-COV-MICRO-35-THEOREM-OBJECT-DISCHARGE-PHASE1-COMPLETE-TRANSITION-v0",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_PHASE1_COMPLETION_v0: CYCLE35_PHASE1_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE35_v0: THEOREM_OBJECT_DISCHARGE_PHASE1_COMPLETION_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE35_ARTIFACT_v0: sr_covariance_theorem_object_discharge_phase1_completion_transition_cycle35_v0",
        "formal/output/sr_covariance_theorem_object_discharge_phase1_completion_transition_cycle35_v0.json",
        "Cycle-036 phase-II canonical-equivalence surface entry lock",
        "TARGET-SR-COV-MICRO-36-CANONICAL-EQUIVALENCE-SURFACE-ENTRY-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_SURFACE_ENTRY_LOCK_v0: CYCLE36_PHASE2_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE36_v0: PHASE2_CANONICAL_EQUIVALENCE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE36_ARTIFACT_v0: sr_covariance_canonical_equivalence_surface_entry_lock_cycle36_v0",
        "formal/output/sr_covariance_canonical_equivalence_surface_entry_lock_cycle36_v0.json",
        "Cycle-037 phase-II canonical-equivalence theorem-surface lock",
        "TARGET-SR-COV-MICRO-37-CANONICAL-EQUIVALENCE-THEOREM-SURFACE-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_LOCK_v0: CYCLE37_PHASE2_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE37_v0: PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE37_ARTIFACT_v0: sr_covariance_canonical_equivalence_theorem_surface_lock_cycle37_v0",
        "formal/output/sr_covariance_canonical_equivalence_theorem_surface_lock_cycle37_v0.json",
        "Cycle-038 phase-II canonical-equivalence theorem-object linkage lock",
        "TARGET-SR-COV-MICRO-38-CANONICAL-EQUIVALENCE-THEOREM-OBJECT-LINKAGE-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_LOCK_v0: CYCLE38_PHASE2_THEOREM_OBJECT_LINKAGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE38_v0: PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE38_ARTIFACT_v0: sr_covariance_canonical_equivalence_theorem_object_linkage_lock_cycle38_v0",
        "formal/output/sr_covariance_canonical_equivalence_theorem_object_linkage_lock_cycle38_v0.json",
        "Cycle-039 phase-II canonical-equivalence pre-discharge criteria lock",
        "TARGET-SR-COV-MICRO-39-CANONICAL-EQUIVALENCE-PREDISCHARGE-CRITERIA-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_LOCK_v0: CYCLE39_PHASE2_PREDISCHARGE_CRITERIA_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE39_v0: PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE39_ARTIFACT_v0: sr_covariance_canonical_equivalence_predischarge_criteria_lock_cycle39_v0",
        "formal/output/sr_covariance_canonical_equivalence_predischarge_criteria_lock_cycle39_v0.json",
        "Cycle-040 phase-II canonical-equivalence adjudication-transition lock",
        "TARGET-SR-COV-MICRO-40-CANONICAL-EQUIVALENCE-ADJUDICATION-TRANSITION-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_LOCK_v0: CYCLE40_PHASE2_ADJUDICATION_TRANSITION_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE40_v0: PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE40_ARTIFACT_v0: sr_covariance_canonical_equivalence_adjudication_transition_lock_cycle40_v0",
        "formal/output/sr_covariance_canonical_equivalence_adjudication_transition_lock_cycle40_v0.json",
        "Cycle-041 phase-II canonical-equivalence package-freeze lock",
        "TARGET-SR-COV-MICRO-41-CANONICAL-EQUIVALENCE-PACKAGE-FREEZE-LOCK-v0",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_LOCK_v0: CYCLE41_PHASE2_PACKAGE_FREEZE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE41_v0: PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE41_ARTIFACT_v0: sr_covariance_canonical_equivalence_package_freeze_lock_cycle41_v0",
        "formal/output/sr_covariance_canonical_equivalence_package_freeze_lock_cycle41_v0.json",
        "Cycle-042 phase-III assumption-minimization discharge surface-entry lock",
        "TARGET-SR-COV-MICRO-42-ASSUMPTION-MINIMIZATION-DISCHARGE-SURFACE-ENTRY-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE42_PHASE3_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE42_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE42_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_surface_entry_lock_cycle42_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_surface_entry_lock_cycle42_v0.json",
        "Cycle-043 phase-III assumption-minimization discharge theorem-surface lock",
        "TARGET-SR-COV-MICRO-43-ASSUMPTION-MINIMIZATION-DISCHARGE-THEOREM-SURFACE-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE43_PHASE3_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE43_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE43_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_theorem_surface_lock_cycle43_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_theorem_surface_lock_cycle43_v0.json",
        "Cycle-044 phase-III robustness discharge surface-entry lock",
        "TARGET-SR-COV-MICRO-44-ROBUSTNESS-DISCHARGE-SURFACE-ENTRY-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_ROBUSTNESS_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE44_PHASE3_ROBUSTNESS_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ROBUSTNESS_DISCHARGE_ENTRY_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE44_v0: PHASE3_ROBUSTNESS_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE44_ARTIFACT_v0: sr_covariance_assumption_robustness_discharge_surface_entry_lock_cycle44_v0",
        "formal/output/sr_covariance_assumption_robustness_discharge_surface_entry_lock_cycle44_v0.json",
        "Cycle-045 phase-III robustness discharge theorem-surface lock",
        "TARGET-SR-COV-MICRO-45-ROBUSTNESS-DISCHARGE-THEOREM-SURFACE-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE45_PHASE3_ROBUSTNESS_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE45_v0: PHASE3_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE45_ARTIFACT_v0: sr_covariance_assumption_robustness_discharge_theorem_surface_lock_cycle45_v0",
        "formal/output/sr_covariance_assumption_robustness_discharge_theorem_surface_lock_cycle45_v0.json",
        "Cycle-046 phase-III negative-control discharge surface-entry lock",
        "TARGET-SR-COV-MICRO-46-NEGCTRL-DISCHARGE-SURFACE-ENTRY-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_NEGCTRL_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE46_PHASE3_NEGCTRL_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_NEGCTRL_DISCHARGE_ENTRY_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE46_v0: PHASE3_NEGCTRL_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE46_ARTIFACT_v0: sr_covariance_assumption_negctrl_discharge_surface_entry_lock_cycle46_v0",
        "formal/output/sr_covariance_assumption_negctrl_discharge_surface_entry_lock_cycle46_v0.json",
        "Cycle-047 phase-III negative-control discharge theorem-surface lock",
        "TARGET-SR-COV-MICRO-47-NEGCTRL-DISCHARGE-THEOREM-SURFACE-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_NEGCTRL_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE47_PHASE3_NEGCTRL_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_NEGCTRL_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE47_v0: PHASE3_NEGCTRL_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE47_ARTIFACT_v0: sr_covariance_assumption_negctrl_discharge_theorem_surface_lock_cycle47_v0",
        "formal/output/sr_covariance_assumption_negctrl_discharge_theorem_surface_lock_cycle47_v0.json",
        "Cycle-048 phase-III assumption-minimization discharge package-freeze lock",
        "TARGET-SR-COV-MICRO-48-ASSUMPTION-MINIMIZATION-DISCHARGE-PACKAGE-FREEZE-LOCK-v0",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_LOCK_v0: CYCLE48_PHASE3_PACKAGE_FREEZE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE48_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE48_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_package_freeze_lock_cycle48_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_package_freeze_lock_cycle48_v0.json",
        "MATH|DEF|POLICY|SCOPE",
        "TARGET-SR-DERIV-COMPLETENESS-GATE-PLAN",
        "TOE-SR-THM-01",
        "formal/toe_formal/ToeFormal/SR/CovarianceObjectDischargeStub.lean",
        "test_sr_full_derivation_enforcement_roadmap_gate.py",
    ]

    missing = [tok for tok in required_tokens if tok not in text]
    assert not missing, "Missing required SR enforcement-roadmap token(s): " + ", ".join(missing)


def test_sr_enforcement_roadmap_is_synced_with_state_and_physics_roadmap() -> None:
    state_text = _read(STATE_PATH)
    roadmap_text = _read(ROADMAP_PATH)

    required_state_tokens = [
        "TARGET-SR-FULL-DERIVATION-ENFORCEMENT-ROADMAP-PLAN",
        "formal/docs/paper/DERIVATION_TARGET_SR_FULL_DERIVATION_ENFORCEMENT_ROADMAP_v0.md",
        "SR_FULL_DERIVATION_ENFORCEMENT_ADJUDICATION: DISCHARGED_v0_ROADMAP_PINNED",
        "SR_FULL_DERIVATION_ENFORCEMENT_MODE_v0: AUTHORITATIVE_NO_DEVIATION",
        "SR_FULL_DERIVATION_ENFORCEMENT_PHASE_ORDER_v0: PHASE1_OBJECTS>PHASE2_EQUIV>PHASE3_ASSUMPTIONS>PHASE4_ROBUST_NEGCTRL>PHASE5_DERIVATION_GATE>PHASE6_INEVITABILITY>PHASE7_FREEZE",
        "SR_COVARIANCE_THEOREM_OBJECT_PHASE_EXIT_BINDING_v0: CYCLE29_PHASE_EXIT_TOKENS_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_EXIT_v0: OBJECT_THEOREM_SURFACES_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_EXIT_v0: CANONICAL_EQUIVALENCE_SURFACE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_EXIT_v0: ASSUMPTION_MINIMIZATION_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_EXIT_v0: ROBUSTNESS_NEGCTRL_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_EXIT_v0: DERIVATION_COMPLETENESS_GATE_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_EXIT_v0: INEVITABILITY_GATE_DISCHARGE_BOUND_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE7_EXIT_v0: PACKAGE_FREEZE_REOPEN_POLICY_BOUND_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE29_v0: THEOREM_OBJECT_PHASE_EXIT_BINDING_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE29_ARTIFACT_v0: sr_covariance_theorem_object_phase_exit_binding_cycle29_v0",
        "formal/output/sr_covariance_theorem_object_phase_exit_binding_cycle29_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_PROGRESSION_v0: CYCLE30_PHASE1_DISCHARGE_PROGRESS_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_01_v0: LORENTZ_TRANSFORM_OBJECT_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_02_v0: INTERVAL_INVARIANCE_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_03_v0: VELOCITY_COMPOSITION_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_04_v0: COVARIANCE_CONTRACT_SURFACE_PROGRESS_PINNED",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_PROGRESS_v0: ROWS_01_04_POPULATED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE30_v0: THEOREM_OBJECT_DISCHARGE_PROGRESSION_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE30_ARTIFACT_v0: sr_covariance_theorem_object_discharge_progression_cycle30_v0",
        "formal/output/sr_covariance_theorem_object_discharge_progression_cycle30_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW01_LOCK_v0: CYCLE31_PHASE1_ROW01_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_01_STATUS_v0: LORENTZ_TRANSFORM_OBJECT_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE31_v0: THEOREM_OBJECT_DISCHARGE_ROW01_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE31_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row01_lock_cycle31_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row01_lock_cycle31_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW02_LOCK_v0: CYCLE32_PHASE1_ROW02_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_02_STATUS_v0: INTERVAL_INVARIANCE_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE32_v0: THEOREM_OBJECT_DISCHARGE_ROW02_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE32_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row02_lock_cycle32_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row02_lock_cycle32_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW03_LOCK_v0: CYCLE33_PHASE1_ROW03_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_03_STATUS_v0: VELOCITY_COMPOSITION_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE33_v0: THEOREM_OBJECT_DISCHARGE_ROW03_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE33_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row03_lock_cycle33_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row03_lock_cycle33_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_ROW04_LOCK_v0: CYCLE34_PHASE1_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_04_STATUS_v0: COVARIANCE_CONTRACT_SURFACE_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE34_v0: THEOREM_OBJECT_DISCHARGE_ROW04_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE34_ARTIFACT_v0: sr_covariance_theorem_object_discharge_row04_lock_cycle34_v0",
        "formal/output/sr_covariance_theorem_object_discharge_row04_lock_cycle34_v0.json",
        "SR_COVARIANCE_THEOREM_OBJECT_DISCHARGE_PHASE1_COMPLETION_v0: CYCLE35_PHASE1_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE35_v0: THEOREM_OBJECT_DISCHARGE_PHASE1_COMPLETION_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE35_ARTIFACT_v0: sr_covariance_theorem_object_discharge_phase1_completion_transition_cycle35_v0",
        "formal/output/sr_covariance_theorem_object_discharge_phase1_completion_transition_cycle35_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_SURFACE_ENTRY_LOCK_v0: CYCLE36_PHASE2_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE36_v0: PHASE2_CANONICAL_EQUIVALENCE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE36_ARTIFACT_v0: sr_covariance_canonical_equivalence_surface_entry_lock_cycle36_v0",
        "formal/output/sr_covariance_canonical_equivalence_surface_entry_lock_cycle36_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_LOCK_v0: CYCLE37_PHASE2_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE37_v0: PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE37_ARTIFACT_v0: sr_covariance_canonical_equivalence_theorem_surface_lock_cycle37_v0",
        "formal/output/sr_covariance_canonical_equivalence_theorem_surface_lock_cycle37_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_LOCK_v0: CYCLE38_PHASE2_THEOREM_OBJECT_LINKAGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE38_v0: PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE38_ARTIFACT_v0: sr_covariance_canonical_equivalence_theorem_object_linkage_lock_cycle38_v0",
        "formal/output/sr_covariance_canonical_equivalence_theorem_object_linkage_lock_cycle38_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_LOCK_v0: CYCLE39_PHASE2_PREDISCHARGE_CRITERIA_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE39_v0: PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE39_ARTIFACT_v0: sr_covariance_canonical_equivalence_predischarge_criteria_lock_cycle39_v0",
        "formal/output/sr_covariance_canonical_equivalence_predischarge_criteria_lock_cycle39_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_LOCK_v0: CYCLE40_PHASE2_ADJUDICATION_TRANSITION_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE40_v0: PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE40_ARTIFACT_v0: sr_covariance_canonical_equivalence_adjudication_transition_lock_cycle40_v0",
        "formal/output/sr_covariance_canonical_equivalence_adjudication_transition_lock_cycle40_v0.json",
        "SR_COVARIANCE_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_LOCK_v0: CYCLE41_PHASE2_PACKAGE_FREEZE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE41_v0: PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE41_ARTIFACT_v0: sr_covariance_canonical_equivalence_package_freeze_lock_cycle41_v0",
        "formal/output/sr_covariance_canonical_equivalence_package_freeze_lock_cycle41_v0.json",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE42_PHASE3_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE42_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE42_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_surface_entry_lock_cycle42_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_surface_entry_lock_cycle42_v0.json",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE43_PHASE3_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_COMPLETION_STATUS_v0: THEOREM_OBJECT_ROWS_01_04_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_ENTRY_STATUS_v0: CANONICAL_EQUIVALENCE_SURFACE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_OBJECT_LINKAGE_STATUS_v0: LINKAGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PREDISCHARGE_CRITERIA_STATUS_v0: CRITERIA_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_ADJUDICATION_TRANSITION_STATUS_v0: ADJUDICATION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_ROW_LOCK_PROGRESS_v0: ROW01_ROW02_ROW03_ROW04_DISCHARGE_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE43_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE43_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_theorem_surface_lock_cycle43_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_theorem_surface_lock_cycle43_v0.json",
        "SR_COVARIANCE_ASSUMPTION_ROBUSTNESS_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE44_PHASE3_ROBUSTNESS_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ROBUSTNESS_DISCHARGE_ENTRY_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE44_v0: PHASE3_ROBUSTNESS_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE44_ARTIFACT_v0: sr_covariance_assumption_robustness_discharge_surface_entry_lock_cycle44_v0",
        "formal/output/sr_covariance_assumption_robustness_discharge_surface_entry_lock_cycle44_v0.json",
        "SR_COVARIANCE_ASSUMPTION_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE45_PHASE3_ROBUSTNESS_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE45_v0: PHASE3_ROBUSTNESS_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE45_ARTIFACT_v0: sr_covariance_assumption_robustness_discharge_theorem_surface_lock_cycle45_v0",
        "formal/output/sr_covariance_assumption_robustness_discharge_theorem_surface_lock_cycle45_v0.json",
        "SR_COVARIANCE_ASSUMPTION_NEGCTRL_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE46_PHASE3_NEGCTRL_ENTRY_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_NEGCTRL_DISCHARGE_ENTRY_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE46_v0: PHASE3_NEGCTRL_DISCHARGE_SURFACE_ENTRY_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE46_ARTIFACT_v0: sr_covariance_assumption_negctrl_discharge_surface_entry_lock_cycle46_v0",
        "formal/output/sr_covariance_assumption_negctrl_discharge_surface_entry_lock_cycle46_v0.json",
        "SR_COVARIANCE_ASSUMPTION_NEGCTRL_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE47_PHASE3_NEGCTRL_THEOREM_SURFACE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_NEGCTRL_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE47_v0: PHASE3_NEGCTRL_DISCHARGE_THEOREM_SURFACE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE47_ARTIFACT_v0: sr_covariance_assumption_negctrl_discharge_theorem_surface_lock_cycle47_v0",
        "formal/output/sr_covariance_assumption_negctrl_discharge_theorem_surface_lock_cycle47_v0.json",
        "SR_COVARIANCE_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_LOCK_v0: CYCLE48_PHASE3_PACKAGE_FREEZE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_COVARIANCE_PROGRESS_CYCLE48_v0: PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_PACKAGE_FREEZE_LOCK_TOKEN_PINNED",
        "SR_COVARIANCE_CYCLE48_ARTIFACT_v0: sr_covariance_assumption_minimization_discharge_package_freeze_lock_cycle48_v0",
        "formal/output/sr_covariance_assumption_minimization_discharge_package_freeze_lock_cycle48_v0.json",
    ]
    for token in required_state_tokens:
        assert token in state_text, f"Missing SR enforcement token in state: {token}"

    required_roadmap_tokens = [
        "TARGET-SR-FULL-DERIVATION-ENFORCEMENT-ROADMAP-PLAN",
        "formal/docs/paper/DERIVATION_TARGET_SR_FULL_DERIVATION_ENFORCEMENT_ROADMAP_v0.md",
        "authoritative no-deviation full-derivation/discharge/inevitability roadmap",
    ]
    for token in required_roadmap_tokens:
        assert token in roadmap_text, f"Missing SR enforcement token in physics roadmap: {token}"


def test_sr_enforcement_roadmap_cycle49_to_cycle74_tokens_are_present() -> None:
    text = _read(SR_ENFORCEMENT_ROADMAP_PATH)

    required_tokens = [
        "Cycle-049 phase-III completion transition lock",
        "SR_COVARIANCE_PHASE3_DISCHARGE_COMPLETION_LOCK_v0: CYCLE49_PHASE3_COMPLETION_PINNED_NONCLAIM",
        "Cycle-050 phase-IV robustness/negative-control discharge surface-entry lock",
        "SR_COVARIANCE_PHASE4_ROBUSTNESS_NEGCTRL_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE50_PHASE4_ENTRY_SURFACE_PINNED_NONCLAIM",
        "Cycle-051 phase-IV robustness/negative-control discharge theorem-surface lock",
        "SR_COVARIANCE_PHASE4_ROBUSTNESS_NEGCTRL_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE51_PHASE4_THEOREM_SURFACE_PINNED_NONCLAIM",
        "Cycle-052 phase-IV robustness/negative-control discharge package-freeze lock",
        "SR_COVARIANCE_PHASE4_ROBUSTNESS_NEGCTRL_DISCHARGE_PACKAGE_FREEZE_LOCK_v0: CYCLE52_PHASE4_PACKAGE_FREEZE_PINNED_NONCLAIM",
        "Cycle-053 phase-IV completion transition lock",
        "SR_COVARIANCE_PHASE4_DISCHARGE_COMPLETION_LOCK_v0: CYCLE53_PHASE4_COMPLETION_PINNED_NONCLAIM",
        "Cycle-054 phase-V derivation-completeness discharge surface-entry lock",
        "SR_COVARIANCE_PHASE5_DERIVATION_COMPLETENESS_DISCHARGE_SURFACE_ENTRY_LOCK_v0: CYCLE54_PHASE5_ENTRY_SURFACE_PINNED_NONCLAIM",
        "Cycle-055 phase-V derivation-completeness discharge theorem-surface lock",
        "SR_COVARIANCE_PHASE5_DERIVATION_COMPLETENESS_DISCHARGE_THEOREM_SURFACE_LOCK_v0: CYCLE55_PHASE5_THEOREM_SURFACE_PINNED_NONCLAIM",
        "Cycle-056 phase-V completion transition lock",
        "SR_COVARIANCE_PHASE5_DISCHARGE_COMPLETION_LOCK_v0: CYCLE56_PHASE5_COMPLETION_PINNED_NONCLAIM",
        "Cycle-057 phase-VI inevitability necessity theorem-surface lock",
        "SR_COVARIANCE_PHASE6_INEVITABILITY_NECESSITY_THEOREM_SURFACE_LOCK_v0: CYCLE57_PHASE6_NECESSITY_SURFACE_PINNED_NONCLAIM",
        "Cycle-058 phase-VI inevitability counterfactual negative-control theorem-surface lock",
        "SR_COVARIANCE_PHASE6_INEVITABILITY_COUNTERFACTUAL_NEGCTRL_THEOREM_SURFACE_LOCK_v0: CYCLE58_PHASE6_COUNTERFACTUAL_NEGCTRL_SURFACE_PINNED_NONCLAIM",
        "Cycle-059 phase-VI completion transition lock",
        "SR_COVARIANCE_PHASE6_DISCHARGE_COMPLETION_LOCK_v0: CYCLE59_PHASE6_COMPLETION_PINNED_NONCLAIM",
        "Cycle-060 phase-VII package-freeze/reopen-policy lock",
        "SR_COVARIANCE_PHASE7_PACKAGE_FREEZE_REOPEN_POLICY_LOCK_v0: CYCLE60_PHASE7_FREEZE_REOPEN_PINNED_NONCLAIM",
        "formal/output/sr_covariance_phase7_package_freeze_reopen_policy_lock_cycle60_v0.json",
        "Cycle-061 phase-I discharge-grade theorem-object replacement lock",
        "SR_COVARIANCE_PHASE1_DISCHARGE_GRADE_THEOREM_OBJECTS_LOCK_v0: CYCLE61_PHASE1_DISCHARGE_GRADE_OBJECTS_PINNED_NONCLAIM",
        "Cycle-062 phase-II canonical-equivalence theorem discharge lock",
        "SR_COVARIANCE_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_DISCHARGE_LOCK_v0: CYCLE62_PHASE2_EQUIVALENCE_DISCHARGE_PINNED_NONCLAIM",
        "Cycle-063 phase-III assumption-minimization discharge completion lock",
        "SR_COVARIANCE_PHASE3_ASSUMPTION_MINIMIZATION_DISCHARGE_COMPLETION_LOCK_v0: CYCLE63_PHASE3_ASSUMPTION_MINIMIZATION_COMPLETION_PINNED_NONCLAIM",
        "Cycle-064 phase-IV theorem-linked robustness/negative-control discharge completion lock",
        "SR_COVARIANCE_PHASE4_THEOREM_LINKED_ROBUSTNESS_NEGCTRL_DISCHARGE_COMPLETION_LOCK_v0: CYCLE64_PHASE4_THEOREM_LINKED_ROBUSTNESS_NEGCTRL_COMPLETION_PINNED_NONCLAIM",
        "Cycle-065 phase-V derivation-completeness gate closure lock",
        "SR_DERIVATION_COMPLETENESS_GATE_CLOSURE_LOCK_v0: CYCLE65_PHASE5_GATE_CLOSURE_PINNED_NONCLAIM",
        "Cycle-066 phase-VI inevitability necessity/counterfactual discharge completion lock",
        "SR_COVARIANCE_PHASE6_INEVITABILITY_NECESSITY_COUNTERFACTUAL_DISCHARGE_COMPLETION_LOCK_v0: CYCLE66_PHASE6_NECESSITY_COUNTERFACTUAL_COMPLETION_PINNED_NONCLAIM",
        "Cycle-067 phase-VII governance promotion-readiness lock",
        "SR_COVARIANCE_PHASE7_GOVERNANCE_PROMOTION_READINESS_LOCK_v0: CYCLE67_PHASE7_PROMOTION_READINESS_PINNED_NONCLAIM",
        "formal/output/sr_covariance_phase7_governance_promotion_readiness_lock_cycle67_v0.json",
        "Cycle-068 phase-I discharge-grade theorem-replacement closure lock",
        "SR_COVARIANCE_PHASE1_DISCHARGE_GRADE_THEOREM_REPLACEMENT_CLOSURE_LOCK_v0: CYCLE68_PHASE1_REPLACEMENT_CLOSURE_PINNED_NONCLAIM",
        "Cycle-069 phase-II canonical-equivalence theorem-discharge completion lock",
        "SR_COVARIANCE_PHASE2_CANONICAL_EQUIVALENCE_THEOREM_DISCHARGE_COMPLETION_LOCK_v0: CYCLE69_PHASE2_EQUIVALENCE_DISCHARGE_COMPLETION_PINNED_NONCLAIM",
        "Cycle-070 phase-V derivation-completeness failure-trigger discharge lock",
        "SR_DERIVATION_COMPLETENESS_FAILURE_TRIGGER_DISCHARGE_LOCK_v0: CYCLE70_PHASE5_FAILURE_TRIGGER_DISCHARGE_PINNED_NONCLAIM",
        "Cycle-071 phase-VI inevitability theorem-discharge closure lock",
        "SR_COVARIANCE_PHASE6_INEVITABILITY_THEOREM_DISCHARGE_CLOSURE_LOCK_v0: CYCLE71_PHASE6_INEVITABILITY_THEOREM_CLOSURE_PINNED_NONCLAIM",
        "Cycle-072 phase-VII governance claim-promotion execution lock",
        "SR_COVARIANCE_PHASE7_GOVERNANCE_CLAIM_PROMOTION_EXECUTION_LOCK_v0: CYCLE72_PHASE7_PROMOTION_EXECUTION_PINNED_NONCLAIM",
        "formal/output/sr_covariance_phase7_governance_claim_promotion_execution_lock_cycle72_v0.json",
        "Cycle-073 phase-V/VI theorem-discharge adjudication transition lock",
        "SR_COVARIANCE_PHASE5_PHASE6_THEOREM_DISCHARGE_ADJUDICATION_LOCK_v0: CYCLE73_PHASE5_PHASE6_ADJUDICATION_PINNED_NONCLAIM",
        "formal/output/sr_covariance_phase5_phase6_theorem_discharge_adjudication_transition_lock_cycle73_v0.json",
        "Cycle-074 claim-label and pillar-closure transition lock",
        "SR_COVARIANCE_CLAIM_LABEL_AND_PILLAR_CLOSURE_TRANSITION_LOCK_v0: CYCLE74_RESULTS_MATRIX_CLOSURE_PINNED",
        "formal/output/sr_covariance_claim_label_and_pillar_closure_transition_lock_cycle74_v0.json",
    ]

    missing = [tok for tok in required_tokens if tok not in text]
    assert not missing, "Missing cycle49-74 enforcement-roadmap token(s): " + ", ".join(missing)


def test_sr_enforcement_roadmap_cycle49_to_cycle74_tokens_are_synced_with_state() -> None:
    state_text = _read(STATE_PATH)

    required_state_tokens = [
        "SR_FULL_DERIVATION_PHASE3_COMPLETION_STATUS_v0: ASSUMPTION_MINIMIZATION_ROBUSTNESS_NEGCTRL_DISCHARGE_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_ENTRY_STATUS_v0: ROBUSTNESS_NEGCTRL_DISCHARGE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_DISCHARGE_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_DISCHARGE_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_DISCHARGE_PACKAGE_FREEZE_STATUS_v0: PACKAGE_FREEZE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_COMPLETION_STATUS_v0: ROBUSTNESS_NEGCTRL_DISCHARGE_COMPLETION_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_ENTRY_STATUS_v0: DERIVATION_COMPLETENESS_GATE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_DERIVATION_COMPLETENESS_SURFACE_STATUS_v0: ENTRY_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_DERIVATION_COMPLETENESS_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_COMPLETION_STATUS_v0: DERIVATION_COMPLETENESS_GATE_DISCHARGE_COMPLETION_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_ENTRY_STATUS_v0: INEVITABILITY_GATE_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_NECESSITY_THEOREM_SURFACE_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_COUNTERFACTUAL_NEGCTRL_STATUS_v0: THEOREM_SURFACE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_COMPLETION_STATUS_v0: INEVITABILITY_GATE_DISCHARGE_COMPLETION_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE7_ENTRY_STATUS_v0: PACKAGE_FREEZE_REOPEN_POLICY_ENTRY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE7_PACKAGE_FREEZE_REOPEN_POLICY_STATUS_v0: FROZEN_WATCH_REOPEN_POLICY_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_GRADE_STATUS_v0: THEOREM_OBJECT_REPLACEMENT_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_DISCHARGE_STATUS_v0: THEOREM_EQUIVALENCE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE3_ASSUMPTION_MINIMIZATION_COMPLETION_STATUS_v0: DISCHARGE_RATIONALE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE4_THEOREM_LINKED_ROBUSTNESS_NEGCTRL_COMPLETION_STATUS_v0: FAILURE_INFORMATIVE_DISCHARGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_DERIVATION_COMPLETENESS_GATE_CLOSURE_STATUS_v0: FAILURE_TRIGGER_AUDIT_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_INEVITABILITY_NECESSITY_COUNTERFACTUAL_COMPLETION_STATUS_v0: BOUNDED_INEVITABILITY_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PROMOTION_READINESS_STATUS_v0: PILLAR_STATUS_PROMOTION_INPUTS_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE1_DISCHARGE_GRADE_REPLACEMENT_CLOSURE_STATUS_v0: DISCHARGE_GRADE_THEOREM_REPLACEMENT_CLOSURE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE2_CANONICAL_EQUIVALENCE_DISCHARGE_COMPLETION_STATUS_v0: THEOREM_EQUIVALENCE_DISCHARGE_COMPLETION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_FAILURE_TRIGGER_DISCHARGE_STATUS_v0: MANDATORY_FAILURE_TRIGGER_SET_DISCHARGE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_INEVITABILITY_THEOREM_DISCHARGE_CLOSURE_STATUS_v0: NECESSITY_COUNTERFACTUAL_THEOREM_DISCHARGE_CLOSURE_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE7_GOVERNANCE_CLAIM_PROMOTION_EXECUTION_STATUS_v0: CLAIM_PROMOTION_EXECUTION_SCAFFOLD_PINNED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_FAILURE_TRIGGER_THEOREM_DISCHARGE_STATUS_v0: MANDATORY_FAILURE_TRIGGER_SET_THEOREM_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE6_INEVITABILITY_THEOREM_DISCHARGE_STATUS_v0: NECESSITY_COUNTERFACTUAL_THEOREM_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_PHASE5_PHASE6_THEOREM_DISCHARGE_ADJUDICATION_STATUS_v0: PHASE5_PHASE6_THEOREM_DISCHARGED_NONCLAIM",
        "SR_FULL_DERIVATION_RESULTS_LABEL_STATUS_v0: TOE_SR_THM_01_T_PROVED_BOUNDED_PINNED",
        "SR_FULL_DERIVATION_INEVITABILITY_CLAIM_STATUS_v0: BOUNDED_INEVITABILITY_DISCHARGED_PINNED",
        "SR_FULL_DERIVATION_PILLAR_MATRIX_STATUS_v0: PILLAR_SR_CLOSED_BOUNDED_PINNED",
        "formal/output/sr_covariance_phase3_discharge_completion_lock_cycle49_v0.json",
        "formal/output/sr_covariance_phase7_package_freeze_reopen_policy_lock_cycle60_v0.json",
        "formal/output/sr_covariance_phase1_discharge_grade_theorem_object_replacement_lock_cycle61_v0.json",
        "formal/output/sr_covariance_phase7_governance_promotion_readiness_lock_cycle67_v0.json",
        "formal/output/sr_covariance_phase1_discharge_grade_theorem_replacement_closure_lock_cycle68_v0.json",
        "formal/output/sr_covariance_phase2_canonical_equivalence_theorem_discharge_completion_lock_cycle69_v0.json",
        "formal/output/sr_covariance_phase5_derivation_completeness_failure_trigger_discharge_lock_cycle70_v0.json",
        "formal/output/sr_covariance_phase6_inevitability_theorem_discharge_closure_lock_cycle71_v0.json",
        "formal/output/sr_covariance_phase7_governance_claim_promotion_execution_lock_cycle72_v0.json",
        "formal/output/sr_covariance_phase5_phase6_theorem_discharge_adjudication_transition_lock_cycle73_v0.json",
        "formal/output/sr_covariance_claim_label_and_pillar_closure_transition_lock_cycle74_v0.json",
    ]

    missing = [tok for tok in required_state_tokens if tok not in state_text]
    assert not missing, "Missing cycle49-74 state sync token(s): " + ", ".join(missing)
